"use strict";(self["webpackChunkquasar_frontend"]=self["webpackChunkquasar_frontend"]||[]).push([[846],{846:(e,t,a)=>{a.r(t),a.d(t,{default:()=>Ue});var o=a(3673),l=a(2323);const s={class:"print-hide col-sm-3 bg-grey-1 print-hide"},n={class:" col-sm-9 column q-gutter-md"},i={class:"zcard print-hide q-mt-sm rounded-borders q-pa-md flex justify-between"},r={class:"flex flex-inline q-gutter-sm"},c={class:"zcard bg-grey-1 q-py-md row"},m={class:"col-9 print-hide"},d={class:"zlabel"},p=(0,o.Uk)("Application : "),u={class:"zvalue"},f={class:"zlabel"},v=(0,o.Uk)("Regn No : "),g={class:"zvalue"},b={class:"zlabel"},w=(0,o.Uk)("Submitted At : "),h={class:"zvalue"},W={class:"col-3 flex justify-end print-hide"},y={class:"col-12 zdetailcard  q-my-md print-hide"},q={class:"col-12 zdetailcard q-my-md"};function k(e,t,a,k,S,_){const Z=(0,o.up)("List"),D=(0,o.up)("q-btn"),C=(0,o.up)("certificates"),Q=(0,o.up)("router-view"),U=(0,o.up)("movement"),x=(0,o.up)("q-drawer"),V=(0,o.up)("create-state"),z=(0,o.up)("q-dialog"),j=(0,o.up)("q-page");return(0,o.wg)(),(0,o.j4)(j,{class:"row q-col-gutter-md q-ma-none container-lg"},{default:(0,o.w5)((()=>{var a,S;return[(0,o.Wm)("div",s,[(0,o.Wm)(Z,{notes:k.localData.notes},null,8,["notes"])]),(0,o.Wm)("div",n,[(0,o.Wm)("div",i,[(0,o.Wm)(D,{onClick:k.closeFile,color:"negative",label:"Close"},null,8,["onClick"]),(0,o.Wm)("div",r,[(0,o.Wm)(D,{disable:k.localData.current_step<=0,onClick:k.handleBack,outline:"",color:"negative",label:"Send back"},null,8,["disable","onClick"]),(0,o.Wm)(D,{onClick:k.handleForward,outline:"",color:"primary",label:"Forward"},null,8,["onClick"])])]),(0,o.Wm)("div",c,[(0,o.Wm)("div",m,[(0,o.Wm)("div",d,[p,(0,o.Wm)("span",u,(0,l.zw)(k.localData.application_code),1)]),(0,o.Wm)("div",f,[v,(0,o.Wm)("span",g,(0,l.zw)(null===(a=k.localData)||void 0===a?void 0:a.regn_no),1)]),(0,o.Wm)("div",b,[w,(0,o.Wm)("span",h,(0,l.zw)(null===(S=k.localData)||void 0===S?void 0:S.createdAt),1)])]),(0,o.Wm)("div",W,[(0,o.Wm)(D,{onClick:t[1]||(t[1]=e=>{k.localData.openHistory=!k.localData.openHistory,k.fetchMovements()}),"no-caps":"",outline:"",flat:"",label:"Movement History"}),(0,o.Wm)(D,{to:{name:"application:detail"},"no-caps":"",color:"primary",flat:"",label:"View Application"})]),(0,o.Wm)("div",y,[(0,o.Wm)(C,{id:e.$route.params.id},null,8,["id"])]),(0,o.Wm)("div",q,[(0,o.Wm)(Q,{onNotes:t[2]||(t[2]=e=>k.localData.notes=e)})])])]),(0,o.Wm)(D,{to:{name:"note:create",params:{id:e.$route.params.id}},fab:"",icon:"edit",color:"primary",class:"absolute-bottom-right q-mr-xl q-mb-xl print-hide"},null,8,["to"]),(0,o.Wm)(x,{modelValue:k.localData.openHistory,"onUpdate:modelValue":t[3]||(t[3]=e=>k.localData.openHistory=e),side:"right",behavior:"mobile"},{default:(0,o.w5)((()=>[(0,o.Wm)(U,{movements:k.localData.movements},null,8,["movements"])])),_:1},8,["modelValue"]),(0,o.Wm)(z,{modelValue:k.localData.createStatus,"onUpdate:modelValue":t[5]||(t[5]=e=>k.localData.createStatus=e)},{default:(0,o.w5)((()=>[(0,o.Wm)(V,{onExposeList:t[4]||(t[4]=e=>k.localData.states=e)})])),_:1},8,["modelValue"])]})),_:1})}a(7280),a(5363);var S=a(1959);const _=(0,o.Wm)("h1",{class:"zsubtitle q-ma-md"},"Notes",-1);function Z(e,t,a,s,n,i){const r=(0,o.up)("q-item-label"),c=(0,o.up)("q-item-section"),m=(0,o.up)("q-item"),d=(0,o.up)("q-list"),p=(0,o.Q2)("ripple");return(0,o.wg)(),(0,o.j4)(o.HY,null,[_,(0,o.Wm)(d,{title:"Notes",separator:""},{default:(0,o.w5)((()=>[((0,o.wg)(!0),(0,o.j4)(o.HY,null,(0,o.Ko)(e.$props.notes,(t=>(0,o.wy)(((0,o.wg)(),(0,o.j4)(m,{to:{name:"note:detail",params:{id:e.$route.params.id,note:t.id}},key:t.id,clickable:""},{default:(0,o.w5)((()=>[(0,o.Wm)(c,null,{default:(0,o.w5)((()=>[(0,o.Wm)(r,null,{default:(0,o.w5)((()=>[(0,o.Uk)((0,l.zw)(null===t||void 0===t?void 0:t.title),1)])),_:2},1024),(0,o.Wm)(r,{caption:""},{default:(0,o.w5)((()=>[(0,o.Uk)((0,l.zw)(null===t||void 0===t?void 0:t.written_by),1)])),_:2},1024)])),_:2},1024)])),_:2},1032,["to"])),[[p]]))),128))])),_:1})],64)}var D=a(9582),C=a(5474);const Q={props:["notes"],setup(e,t){(0,D.yj)();return{}}};var U=a(7011),x=a(3414),V=a(2035),z=a(2350),j=a(6489),$=a(7518),L=a.n($);Q.render=Z;const F=Q;L()(Q,"components",{QList:U.Z,QItem:x.Z,QItemSection:V.Z,QItemLabel:z.Z}),L()(Q,"directives",{Ripple:j.Z});var H=a(5616),I=a(8825),A=a(2215);const M={class:"row"},N={class:"flex justify-between col-12"},Y=(0,o.Wm)("p",{class:"zsubtitle"},"Application statuses",-1);function B(e,t,a,s,n,i){const r=(0,o.up)("q-btn"),c=(0,o.up)("q-step"),m=(0,o.up)("q-stepper"),d=(0,o.up)("q-space");return(0,o.wg)(),(0,o.j4)("div",M,[(0,o.Wm)("div",N,[(0,o.WI)(e.$slots,"header",{},(()=>[Y]))]),(0,o.Wm)(r,{flat:"",onClick:t[1]||(t[1]=t=>e.$refs.stepper.previous()),icon:"arrow_left"}),(0,o.Wm)(m,{flat:"",modelValue:s.localState.selected,"onUpdate:modelValue":t[2]||(t[2]=e=>s.localState.selected=e),ref:"stepper","alternative-labels":"",color:"primary",animated:""},{default:(0,o.w5)((()=>[((0,o.wg)(!0),(0,o.j4)(o.HY,null,(0,o.Ko)(e.$props.states,((e,t)=>((0,o.wg)(),(0,o.j4)(c,{onClick:e=>s.localState.selected=t,name:t,title:e.name,icon:"dot",done:!0},{default:(0,o.w5)((()=>[(0,o.Uk)((0,l.zw)(e.remark),1)])),_:2},1032,["onClick","name","title"])))),256))])),_:1},8,["modelValue"]),(0,o.Wm)(d),(0,o.Wm)(r,{flat:"",onClick:t[3]||(t[3]=t=>e.$refs.stepper.next()),icon:"arrow_right"})])}var E=a(8880);const K=(0,o.Wm)("h1",{class:"zsubtitle col-12"},"Update application status",-1),P=(0,o.Uk)(" Maximum File Upload size 2mb "),R={class:"col-xs-12"};function O(e,t,a,l,s,n){const i=(0,o.up)("q-input"),r=(0,o.up)("q-editor"),c=(0,o.up)("q-btn"),m=(0,o.up)("q-file"),d=(0,o.up)("q-form"),p=(0,o.up)("q-card");return(0,o.wg)(),(0,o.j4)(p,{flat:"",style:{"min-width":"480px"}},{default:(0,o.w5)((()=>[(0,o.Wm)(d,{onSubmit:l.submitStatus,class:"row q-col-gutter-md zcard"},{default:(0,o.w5)((()=>[K,(0,o.Wm)(i,{modelValue:l.formData.name,"onUpdate:modelValue":t[1]||(t[1]=e=>l.formData.name=e),outlined:"",class:"col-xs-12",rules:[e=>!!e||"Name is required"],label:"Status"},null,8,["modelValue","rules"]),(0,o.Wm)(r,{class:"col-12",modelValue:l.formData.remark,"onUpdate:modelValue":t[2]||(t[2]=e=>l.formData.remark=e),flat:"","content-class":"bg-amber-3","toolbar-text-color":"white","toolbar-toggle-color":"yellow-8","toolbar-bg":"primary",toolbar:[["bold","italic","underline"],[{label:e.$q.lang.editor.formatting,icon:e.$q.iconSet.editor.formatting,list:"no-icons",options:["p","h3","h4","h5","h6","code"]}],["viewsource"]]},null,8,["modelValue","toolbar"]),(0,o.Wm)(m,{filled:"",class:"col-xs-12","bottom-slots":"","max-file-size":"24800",modelValue:l.formData.attachment,"onUpdate:modelValue":t[4]||(t[4]=e=>l.formData.attachment=e),label:"Attachment",counter:""},{hint:(0,o.w5)((()=>[P])),append:(0,o.w5)((()=>[(0,o.Wm)(c,{round:"",dense:"",flat:"",icon:"add",onClick:t[3]||(t[3]=(0,E.iM)((()=>{}),["stop"]))})])),_:1},8,["modelValue"]),(0,o.Wm)("div",R,[(0,o.Wm)(c,{type:"submit",label:"Submit",color:"primary"})])])),_:1},8,["onSubmit"])])),_:1})}const T={emits:["exposeList"],name:"create-state",setup(e,t){const a=(0,D.yj)(),o=(0,I.Z)(),l=(0,S.qj)({name:"",remark:"",attachment:null}),s=e=>{const s=a.params.id,n=new FormData;n.append("name",l.name),n.append("remark",l.remark),n.append("attachment",l.attachment),C.api.post(`applications/${s}/states`,n).then((a=>{const{list:l,message:s}=a.data;t.emit("exposeList",l),o.notify({type:"positive",message:s}),null===e||void 0===e||e.target.reset()})).catch((e=>{var t;o.notify({type:"negative",message:(null===(t=e.response)||void 0===t?void 0:t.message)||e.toString()})}))};return{formData:l,submitStatus:s}}};var G=a(151),J=a(5269),X=a(4689),ee=a(239),te=a(4974),ae=a(2165);T.render=O;const oe=T;L()(T,"components",{QCard:G.Z,QForm:J.Z,QInput:X.Z,QEditor:ee.Z,QFile:te.Z,QBtn:ae.Z});const le={props:{states:Array},name:"states",components:{CreateState:oe},setup(e,t){const a=(0,S.qj)({selected:0});return{localState:a}}};var se=a(3518),ne=a(6552),ie=a(2025);le.render=B;const re=le;L()(le,"components",{QBtn:ae.Z,QStepper:se.Z,QStep:ne.Z,QSpace:ie.Z});const ce={class:"row"},me={class:"flex justify-between col-12"},de=(0,o.Wm)("p",{class:"zsubtitle"},"Certificate",-1),pe={class:"col-12"},ue={class:"col-12"},fe={class:"flex-inline"};function ve(e,t,a,s,n,i){const r=(0,o.up)("q-space"),c=(0,o.up)("q-btn"),m=(0,o.up)("q-separator"),d=(0,o.up)("q-icon"),p=(0,o.up)("q-item-section"),u=(0,o.up)("q-item-label"),f=(0,o.up)("q-item"),v=(0,o.up)("q-list"),g=(0,o.up)("upload-certificate"),b=(0,o.up)("q-dialog");return(0,o.wg)(),(0,o.j4)("div",ce,[(0,o.Wm)("div",me,[(0,o.WI)(e.$slots,"header",{},(()=>[de,(0,o.Wm)(r),(0,o.Wm)(c,{onClick:t[1]||(t[1]=e=>s.localState.openUpload=!0),outline:"",label:"Upload certificate"})]))]),(0,o.Wm)("div",pe,[(0,o.Wm)(m,{class:"q-my-md"})]),(0,o.Wm)("div",ue,[(0,o.Wm)(v,{separator:""},{default:(0,o.w5)((()=>[((0,o.wg)(!0),(0,o.j4)(o.HY,null,(0,o.Ko)(s.localState.certificates,((e,t)=>((0,o.wg)(),(0,o.j4)(f,{key:t},{default:(0,o.w5)((()=>[(0,o.Wm)(p,{avatar:""},{default:(0,o.w5)((()=>[(0,o.Wm)(d,{name:"attachment"})])),_:1}),(0,o.Wm)(p,null,{default:(0,o.w5)((()=>[(0,o.Wm)(u,null,{default:(0,o.w5)((()=>[(0,o.Uk)((0,l.zw)((null===e||void 0===e?void 0:e.name)||"Certificate"),1)])),_:2},1024)])),_:2},1024),(0,o.Wm)(p,{side:""},{default:(0,o.w5)((()=>[(0,o.Wm)("div",fe,[(0,o.Wm)(c,{onClick:t=>s.downloadCert(e),round:"",flat:"",size:"md",icon:"cloud_download"},null,8,["onClick"]),(0,o.Wm)(c,{onClick:t=>s.deleteCert(e),round:"",flat:"",size:"md",icon:"delete"},null,8,["onClick"])])])),_:2},1024)])),_:2},1024)))),128))])),_:1})]),(0,o.Wm)(b,{modelValue:s.localState.openUpload,"onUpdate:modelValue":t[2]||(t[2]=e=>s.localState.openUpload=e)},{default:(0,o.w5)((()=>[(0,o.Wm)(g,{onExposeList:s.onUploaded},null,8,["onExposeList"])])),_:1},8,["modelValue"])])}const ge=(0,o.Wm)("h1",{class:"zsubtitle col-12"},"Update application status",-1),be=(0,o.Uk)(" Maximum File Upload size 2mb "),we={class:"col-xs-12"};function he(e,t,a,l,s,n){const i=(0,o.up)("q-input"),r=(0,o.up)("q-editor"),c=(0,o.up)("q-btn"),m=(0,o.up)("q-file"),d=(0,o.up)("q-form"),p=(0,o.up)("q-card");return(0,o.wg)(),(0,o.j4)(p,{flat:"",style:{"min-width":"480px"}},{default:(0,o.w5)((()=>[(0,o.Wm)(d,{onSubmit:l.submitStatus,class:"row q-col-gutter-md zcard"},{default:(0,o.w5)((()=>[ge,(0,o.Wm)(i,{modelValue:l.formData.name,"onUpdate:modelValue":t[1]||(t[1]=e=>l.formData.name=e),outlined:"",class:"col-xs-12",rules:[e=>!!e||"Name is required"],label:"Name of certificate"},null,8,["modelValue","rules"]),(0,o.Wm)(r,{class:"col-12",modelValue:l.formData.remark,"onUpdate:modelValue":t[2]||(t[2]=e=>l.formData.remark=e),flat:"","content-class":"bg-amber-3","toolbar-text-color":"white","toolbar-toggle-color":"yellow-8","toolbar-bg":"primary",toolbar:[["bold","italic","underline"],[{label:e.$q.lang.editor.formatting,icon:e.$q.iconSet.editor.formatting,list:"no-icons",options:["p","h3","h4","h5","h6","code"]}],["viewsource"]]},null,8,["modelValue","toolbar"]),(0,o.Wm)(m,{filled:"",class:"col-xs-12","bottom-slots":"","max-file-size":"24800",modelValue:l.formData.attachment,"onUpdate:modelValue":t[4]||(t[4]=e=>l.formData.attachment=e),label:"Attachment",counter:""},{hint:(0,o.w5)((()=>[be])),append:(0,o.w5)((()=>[(0,o.Wm)(c,{round:"",dense:"",flat:"",icon:"add",onClick:t[3]||(t[3]=(0,E.iM)((()=>{}),["stop"]))})])),_:1},8,["modelValue"]),(0,o.Wm)("div",we,[(0,o.Wm)(c,{type:"submit",label:"Submit",color:"primary"})])])),_:1},8,["onSubmit"])])),_:1})}const We={emits:["exposeList"],name:"upload-certificate",setup(e,t){const a=(0,D.yj)(),o=(0,I.Z)(),l=(0,S.qj)({name:"",remark:"",attachment:null}),s=e=>{const s=a.params.id,n=new FormData;n.append("name",l.name),n.append("remark",l.remark),n.append("attachment",l.attachment),C.api.post(`applications/${s}/certificate`,n).then((a=>{const{list:l,message:s}=a.data;t.emit("exposeList",l),o.notify({type:"positive",message:s}),null===e||void 0===e||e.target.reset()})).catch((e=>{var t;o.notify({type:"negative",message:(null===(t=e.response)||void 0===t?void 0:t.message)||e.toString()})}))};return{formData:l,submitStatus:s}}};We.render=he;const ye=We;L()(We,"components",{QCard:G.Z,QForm:J.Z,QInput:X.Z,QEditor:ee.Z,QFile:te.Z,QBtn:ae.Z});const qe={props:{id:Number},name:"certificates",components:{UploadCertificate:ye,CreateState:oe},setup(e,t){const a=(0,I.Z)(),l=(0,D.yj)(),s=(0,S.qj)({openUpload:!1,selected:{},certificates:[]}),n=e=>{s.certificates=e,s.openUpload=!1},i=e=>{C.api.delete(`applications/${l.params.id}/${e.id}/certificate`).then((e=>{s.certificates=e.data.list,a.notify({type:"positive",message:e.data.message})})).catch((e=>{var t;return a.notify({type:"negative",message:(null===(t=e.response)||void 0===t?void 0:t.message)||e.toString()})}))},r=e=>{let t=document.createElement("a");t.href=e.full_path,t.target="_blank",t.click()};return(0,o.bv)((()=>{const e=l.params.id;C.api.get(`applications/${e}/certificates`).then((e=>{const{list:t}=e.data;s.certificates=t})).catch((e=>{var t;a.notify({type:"negative",message:(null===(t=e.response)||void 0===t?void 0:t.message)||e.toString()})}))})),{downloadCert:r,onUploaded:n,deleteCert:i,localState:s}}};var ke=a(5869),Se=a(4554),_e=a(6778);qe.render=ve;const Ze=qe;L()(qe,"components",{QSpace:ie.Z,QBtn:ae.Z,QSeparator:ke.Z,QList:U.Z,QItem:x.Z,QItemSection:V.Z,QIcon:Se.Z,QItemLabel:z.Z,QDialog:_e.Z});const De={components:{Certificates:Ze,CreateState:oe,States:re,Movement:A.Z,List:F},setup(){const e=(0,S.iH)(!0),t=(0,D.yj)(),a=(0,D.tv)(),l=(0,I.Z)(),s=(0,S.qj)({createStatus:!1,notes:[],states:[],openHistory:!1,movements:[]}),n=()=>{const e=t.params.id;C.api.get(`applications/${e}/movements`).then((e=>{s.movements=e.data}))},i=()=>{const e=t.params.id;C.api.get(`applications/${e}/states`).then((e=>{s.states=e.data,console.log(e)}))},r=e=>{C.api.get(`applications/${e}`).then((e=>{const{data:t,action:a}=e.data,{regn_no:o,application_code:l,current_step:n,last_step:i,id:r,created_at:c,profile:m}=t;s.id=r,s.current_step=n,s.last_step=i,s.regn_no=o,s.application_code=l,s.profile=m,s.createdAt=H.ZP.formatDate(new Date(c),"DD-MM-YYYY hh:mm a")})).catch((e=>{var t;let a=(null===(t=e.response)||void 0===t?void 0:t.message)||e.toString();l.notify({type:"negative",message:a})}))},c=e=>{C.api.get(`applications/${e}/notes`).then((e=>[s.notes=e.data.list])).catch((e=>{var t;let a=(null===(t=e.response)||void 0===t?void 0:t.message)||e.toString();l.notify({type:"negative",message:a})}))};(0,o.bv)((()=>{const e=t.params.id;c(e),r(e),i(e)}));const m=()=>{const e=t.params.id;C.api.post(`applications/${e}/forward`).then((e=>{const{message:t,list:o,data:s}=e.data;l.notify({type:"positive",message:t}),a.replace({name:"staff:dashboard"})})).catch((e=>{var t;let a=(null===(t=e.response)||void 0===t?void 0:t.message)||e.toString();l.notify({type:"negative",message:a})}))},d=()=>{s.createStatus=!0},p=()=>{const{id:e}=t.params;C.api.post(`applications/${e}/close`).then((e=>{l.notify({type:"positive",message:e.data.message}),setTimeout((()=>{a.replace({name:"staff:dashboard"})}),1e3)})).catch((e=>{var t;l.notify({type:"negative",message:(null===(t=e.response)||void 0===t?void 0:t.message)||e.toString()})}))},u=()=>{const e=t.params.id;C.api.post(`applications/${e}/backward`).then((e=>{const{message:t,list:o,data:s}=e.data;l.notify({type:"positive",message:t}),a.replace({name:"staff:dashboard"})})).catch((e=>{var t;let a=(null===(t=e.response)||void 0===t?void 0:t.message)||e.toString();l.notify({type:"negative",message:a})}))};return{fetchMovements:n,handleBack:u,leftDrawerOpen:e,localData:s,handleAdd:d,handleForward:m,closeFile:p,toggleLeftDrawer(){e.value=!e.value}}}};var Ce=a(4379),Qe=a(6873);De.render=k;const Ue=De;L()(De,"components",{QPage:Ce.Z,QBtn:ae.Z,QDialog:_e.Z,QCard:G.Z,QDrawer:Qe.Z})}}]);